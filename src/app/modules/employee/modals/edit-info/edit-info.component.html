<h3 mat-dialog-title doUnderline underlinedSize="sm">Редактирование профиля</h3>

<div class="edit-info__header">
	<h4>Общие сведения</h4>
	<div class="edit-info__edit">
		<button mat-button (click)="onEdit()" *ngIf="!isEditMode">
            <span class="edit-info__edit-button mat-body-2 text-disabled">Редактировать </span>
			<img src="../../../../../assets/svg/edit.svg" alt="edit_info" />
		</button>
<!--		<span class="edit-info__edit mat-body-2 text-alert" *ngIf="isEditMode"><sup>*</sup>&nbsp;Обязательные поля</span>-->
	</div>
</div>

<mat-dialog-content class="edit-info__general">
	<ng-container *ngIf="!isEditMode; else editTemplate">
        <div class="edit-info__field">
            <span class="mat-body-2 text-secondary_default">Фамилия</span>
            <p class="edit-info__field-value">{{ user.lastName | placeholder }}</p>
        </div>
        <div class="edit-info__field">
            <span class="mat-body-2 text-secondary_default">Имя</span>
            <p class="edit-info__field-value">{{ user.firstName | placeholder }}</p>
        </div>
        <div class="edit-info__field">
            <span class="mat-body-2 text-secondary_default">Отчество</span>
            <p class="edit-info__field-value">{{ user.middleName | placeholder }}</p>
        </div>
        <div class="edit-info__field">
            <span class="mat-body-2 text-secondary_default">Дата рождения</span>
            <p class="edit-info__field-value">{{ user.dateOfBirth  | date: dateType.FULL | placeholder }}</p>
        </div>
        <div class="edit-info__field">
            <span class="mat-body-2 text-secondary_default">Часы работы</span>
            <p class="edit-info__field-value">{{ user.businessHoursFromUtc | date: 'shortTime' | placeholder }} - {{ user.businessHoursToUtc | date: 'shortTime' | placeholder}}</p>
        </div>
        <div class="edit-info__field">
            <span class="mat-body-2 text-secondary_default">Эмодзи-статус</span>
            <p class="edit-info__field-value">{{ user.status | userStatus: true: true | capitalize: 1 | placeholder}}</p>
        </div>
        <div class="edit-info__field edit-info__about">
            <span class="mat-body-2 text-secondary_default">О себе</span>
            <p class="edit-info__field-value">{{ user.about | placeholder }}</p>
        </div>
    </ng-container>
</mat-dialog-content>

<ng-template #editTemplate [formGroup]="editForm" (ngSubmit)="onSubmit()">
    <do-form-row class="edit-info__template-field">
        <mat-form-field
            [matTooltip]="editForm.controls['surname']?.errors?.['name'] ? 'Фамилия может содержать только буквы, -, ` и пробел.\nФамилия не может начинаться и заканчиваться символами - и `' : ''"
            [matTooltipPosition]="'right'"
        >
            <input matInput formControlName="surname" placeholder="Фамилия" minlength="1" maxlength="45" required />
            <mat-error *ngIf="editForm.controls['surname']?.errors?.['whitespace']"
            >Фамилия не может состоять только из пробелов!
            </mat-error>
        </mat-form-field>
    </do-form-row>
    <do-form-row class="edit-info__template-field">
        <mat-form-field
            [matTooltip]="editForm.controls['name']?.errors?.['name'] ? 'Имя может содержать только буквы, -, ` и пробел.\nИмя не может начинаться и заканчиваться символами - и `' : ''"
            [matTooltipPosition]="'right'"
        >
            <input matInput formControlName="name" placeholder="Имя" minlength="1" maxlength="45" required />
            <mat-error *ngIf="editForm.controls['name']?.errors?.['whitespace']"
            >Имя не может состоять только из пробелов!
            </mat-error>
        </mat-form-field>
    </do-form-row>
    <do-form-row class="edit-info__template-field">
        <mat-form-field>
            <input matInput formControlName="middleName" placeholder="Отчество" minlength="1" maxlength="45" />
            <mat-error *ngIf="editForm.controls['middleName']?.errors?.['whitespace']"
            >Отчество не может состоять только из пробелов!
            </mat-error>
        </mat-form-field>
    </do-form-row>
    <do-form-row class="edit-info__template-field">
        <mat-form-field>
            <input matInput formControlName="dateOfBirth" [matDatepicker]="dayOfBirth" placeholder="Дата рождения" />
                <mat-datepicker-toggle matSuffix [for]="dayOfBirth">
                    <mat-icon matDatepickerToggleIcon>date_range</mat-icon>
                </mat-datepicker-toggle>
                <mat-datepicker #dayOfBirth></mat-datepicker>
        </mat-form-field>
    </do-form-row>
    <do-form-row class="edit-info__template-field">
        <mat-form-field>
            <mat-select formControlName="status" placeholder="Эмодзи-статус">
                <mat-option *ngFor="let status of statuses" [value]="status.statusType">
                    {{ status.statusType | userStatus: true: true | capitalize: 1 }}
                </mat-option>
            </mat-select>
        </mat-form-field>
    </do-form-row>

    <do-form-row label="Время работы" class="edit-info__template-field edit-info__hours">
        <mat-form-field>
            <input matInput formControlName="hours" type="time" placeholder="00:00" />
        </mat-form-field>
    </do-form-row>

    <do-form-row label="О себе" class="edit-info__template-field edit-info__about">
        <mat-form-field appearance="outline">
            <textarea
                #about
                matInput
                autocomplete="off"
                placeholder="Написать..."
                maxlength="150"
                cdkTextareaAutosize="true"
                formControlName="aboutField"
            ></textarea>
            <mat-hint align="start">{{ about.value.length }}/150</mat-hint>
        </mat-form-field>
    </do-form-row>

    <div class="edit-info__buttons">
		<button mat-button (click)="onClose()" class="edit-info__button">Отменить</button>
		<button
			mat-flat-button
			type="submit"
			[disabled]="editForm.invalid"
			color="primary"
			(click)="onSubmit()"
			class="edit-info__button"
		>
			Сохранить
		</button>
	</div>
</ng-template>
