<form [formGroup]="addHoursForm" (ngSubmit)="onSubmit()" autocomplete="off" class="add-hours__form">
	<div class="add-hours__div">
		<mat-form-field class="add-hours__time" floatLabel="always">
			<input matInput formControlName="time" type="text" placeholder="0" />
			<mat-label>Количество часов</mat-label>
			<mat-error *ngIf="addHoursForm.controls['time']?.errors?.min; else errIntNum">
				Минимальное значение должно быть больше 0
			</mat-error>
			<ng-template #errIntNum>
				<mat-error *ngIf="addHoursForm.controls['time']?.errors?.intNum; else errMax">
					Значение может быть только целым числом
				</mat-error>
			</ng-template>
			<ng-template #errMax>
				<mat-error *ngIf="addHoursForm.controls['time']?.errors?.max; else errRequired">
					Превышено максимальное значение
				</mat-error>
			</ng-template>
			<ng-template #errRequired>
				<mat-error *ngIf="addHoursForm.controls['time']?.errors?.required">
					Поле не может быть пустым
				</mat-error>
			</ng-template>
		</mat-form-field>

		<mat-form-field class="add-hours__date" floatLabel="always">
			<mat-label>Месяц</mat-label>
			<mat-select placeholder="{{ selectedDate | dateTime: 'LLLL y' | titlecase }}">
				<mat-option [value]="selectedDate$ | async">
					{{ selectedDate | dateTime: 'LLLL y' | titlecase }}
				</mat-option>
				<mat-option *ngFor="let month of monthOptions" (click)="changeDate(month)">
					<!--  Можно ли вызывать date picker в mat-select? -->
					{{ month | dateTime: 'LLLL y' | titlecase }}
				</mat-option>
			</mat-select>
		</mat-form-field>
	</div>

	<mat-form-field floatLabel="always">
		<mat-label>Выберите проект</mat-label>
		<mat-select formControlName="activity">
			<mat-option
				*ngFor="let workTime of workTimes$ | async"
				[value]="workTime?.id"
				(onSelectionChange)="patchWorkTimeInfoIntoForm(workTime, $event)"
			>
				{{ workTime?.project?.name ?? 'Другое' }}
			</mat-option>
		</mat-select>
	</mat-form-field>
	<mat-form-field floatLabel="always">
		<mat-label>Комментарий</mat-label>
		<textarea
			#comment
			matInput
			formControlName="comment"
			maxlength="500"
			placeholder="Оставьте комментарий для менеджера"
		></textarea>
		<mat-hint>{{ comment.value.length }}/500</mat-hint>
	</mat-form-field>
	<button
		mat-flat-button
		color="primary"
		[loading]="(loading$$ | async) ?? false"
		[disabled]="addHoursForm.invalid || addHoursForm.disabled"
	>
		Сохранить часы
	</button>
</form>
