<div class="navigation">
	<a class="navigation__link" routerLink="/admin/dashboard">Администрирование</a>
	<span>
		<mat-icon>chevron_right</mat-icon>
	</span>
	<a class="navigation__link" routerLink="/departments">Список департаментов</a>
	<span>
		<mat-icon>chevron_right</mat-icon>
	</span>
	<a class="navigation__link">{{ departmentInfo?.name }}</a>
</div>
<h1>{{ departmentInfo?.name }}</h1>
<mat-card class="card card_standard department">
	<div class="department__info">
		<div class="department__header">
			<h3 doUnderline underlinedSize="sm">Общая информация</h3>
			<button mat-flat-button (click)="onEditDepartamentClick()">
				<mat-icon class="department__button-edit">
					<img class="department__button-edit__img" src="assets/svg/edit.svg" alt="edit" />
				</mat-icon>
			</button>
		</div>
		<div class="department__label">
			<p>Директор</p>
			<ng-container *ngIf="departmentInfo?.director; else empty">
				<p>{{ departmentInfo?.director?.firstName }} {{ departmentInfo?.director?.lastName }}</p>
			</ng-container>
		</div>
		<div class="department__label">
			<p>Описание</p>
			<ng-container *ngIf="departmentInfo?.description; else empty">
				<p>{{ departmentInfo?.description }}</p>
			</ng-container>
		</div>
	</div>
	<mat-divider [inset]="true"></mat-divider>
	<div class="department__table table">
		<div class="table__header">
			<h3 doUnderline underlinedSize="sm">
				Сотрудники <span class="mat-h3 primary">{{ totalCount | i18nPlural: peopleCountMap }}</span>
			</h3>
			<button mat-flat-button color="accent" (click)="openDialog()">+ Добавить сотрудников</button>
		</div>
		<div class="search-actions">
			<div class="search">
				<mat-form-field class="search__name" appearance="fill">
					<mat-icon matPrefix class="search__button">search</mat-icon>
					<mat-label>Поиск по фамилии и имени</mat-label>
					<input matInput type="search" placeholder="Романов Владислав" />
				</mat-form-field>

				<mat-form-field appearance="fill" class="search__position">
					<mat-label>Выберите должность</mat-label>
					<mat-select>
						<mat-option *ngFor="let position of positions" [value]="position">
							{{ position }}
						</mat-option>
					</mat-select>
				</mat-form-field>
			</div>

			<div class="actions" *ngIf="showActions; else null">
				<div class="actions__chosen-value">Выбрано {{ checkedNum }} сотрудников</div>
				<button mat-button class="actions__menu" [matMenuTriggerFor]="menu">Действия</button>
				<mat-menu #menu="matMenu">
					<button mat-menu-item>1-й вариант</button>
					<button mat-menu-item>2-й вариант</button>
					<button mat-menu-item>3-й вариант</button>
				</mat-menu>
			</div>
		</div>
		<table class="table__content" matSort (matSortChange)="sortData($event)">
			<colgroup>
				<col class="table__column table__column_width_little" />
			</colgroup>
			<tr>
				<th>
					<mat-checkbox
						class="user-row__checkbox"
						[checked]="allComplete"
						(change)="checkedAll($event.checked)"
					>
					</mat-checkbox>
				</th>
				<th mat-sort-header="name">Имя</th>
				<th mat-sort-header="role">Роль</th>
				<th mat-sort-header="rate">Ставка</th>
				<th mat-sort-header="status">Статус</th>
			</tr>
			<ng-container *ngFor="let userInfo of sortedUsersInfo">
				<tr class="table__row">
					<td>
						<mat-checkbox [checked]="allComplete" (change)="checkedCount($event.checked)"></mat-checkbox>
					</td>
					<td>
						<div class="main-info">
							<do-profile-image class="profile-photo" [image]="userInfo?.avatar"></do-profile-image>
							<div>
								<div>{{ userInfo.firstName }} {{ userInfo.lastName }}</div>
								<div class="mat-body-1">{{ userInfo?.position?.name }}</div>
							</div>
						</div>
					</td>
					<td>
						<ng-container *ngIf="userInfo?.role?.name; else empty">
							{{ userInfo?.role?.name }}
						</ng-container>
					</td>
					<td>
						<ng-container *ngIf="userInfo?.rate; else empty">
							{{ userInfo.rate }}
						</ng-container>
					</td>
					<td>
						<ng-container *ngIf="userInfo?.isActive; else archived">
							<div class="user-status">Активен</div>
						</ng-container>
						<ng-template #archived>
							<div class="user-status user-status_archived">В архиве</div>
						</ng-template>
					</td>
				</tr>
			</ng-container>
		</table>
	</div>
</mat-card>

<ng-template #empty>
	<div>—</div>
</ng-template>
